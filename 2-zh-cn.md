# 2.HTTP/2 协议综述

HTTP/2 基于 HTTP 语义提供了优化的传输机制。HTTP/2 支持所有 HTTP/1.1 的核心特性，并在如下几个方面对其进行了改进。

HTTP/2 中基础的协议单元是帧（见第 4.1 节）。每个类型的帧都服务于不同的目的。例如 HEADERS 和 DATA 帧构成了基本的 HTTP 请求与应答 (8.1 节）; 其他诸如 SETTINGS, WINDOW_UPDATE, PUSH_PROMISE 等帧类型用于支持其他的 HTTP/2 特性。

请求的多路复用即每个 HTTP 请求/应答在各自的流 (stream) 中完成数据交换。由于每个流之间都是相互独立的，因此即使请求和应答被阻塞或速度很慢也不会影响各自流中的处理进程。

流量控制以及优先级机制可以保证有效的利用流的多路复用。流量控制（见 5.2 节）确保只有接受者会使用的数据被传输。优先级机制可以确保有限的资源被优先传输到最重要的流。

HTTP/2 中增加了一种新的交互模式，即服务端可以将应答推送给客户端（见 8.2 节）。服务器推送机制允许服务器预测客户端可能需要的数据，并将其推送给客户端，这是一种以增加网络使用来减少延迟的折衷设计。服务器首先合成一个带有 PUSH_PROMISE 帧的请求，随后服务器可以在另一个流中响应这个请求。

由于连接中使用的 HTTP 头包含大量冗余数据，因此包含它们的帧均需进行压缩（见 4.3 节）。一般情况下，经过压缩后对于请求大小的影响很显著，可以将多个请求压缩到一个包 (packet) 中。

## 2.1 文档结构

HTTP/2 标准说明包含以下四个部分：
+ 发起 HTTP/2 请求（见第 3 节） 主要讨论一个 HTTP/2 链接是如何初始化的
+ 帧（见第 4 节）与 流（见第 5 节） 主要讨论 HTTP/2 帧的结构以及如何组成多路复用的流
+ 帧（见第 6 节）与 错误定义（见第 7 节） 主要讨论帧的细节以及 HTTP/2 中的错误类型
+ HTTP 映射（见第 8 节）及附加要求（见第 9 节）主要讨论如何使用帧和流来表述 HTTP 语义

由于部分帧与流中的层的定义与 HTTP 无关，因此该标准中并没有提供完整的帧层的定义。帧与流的层均针对 HTTP 协议与服务器推送进行一定程度的裁剪。

## 2.2 约定与术语

对于关键词"MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" 的定义以 RFC 2119[RFC2119] 中解释为准。

所有数值均使用网络字节序。如未特别指出，所有值均为无符号的。本文中数值根据需要可以为十进制和十六进制。十六进制数值以“0x”开头，以示区分。

该标准中主要使用的术语包括：

+ 客户端 (client): 即发起 HTTP/2 连接的端点 (endpoint). 客户端发出 HTTP 请求，并接收 HTTP 应答。
+ 连接 (connection): 两个端点之间的传输层连接
+ 连接错误 (connection error): 影响 HTTP/2 连接的错误
+ 端点 (endpoint): 连接的客户端或服务端
+ 帧 (frame): HTTP/2 连接中的最小通讯单元，由帧头与任意长度的字节流组成，字节流的具体结构由帧类型决定。
+ 节点 (peer): 一类特殊的端点，主要用来代指在讨论中与主要端点对应的远端端点
+ 接收端：接收帧的端点
+ 发送端：发送帧的端点
+ 服务器：接收 HTTP/2 连接的端点。服务器接收 HTTP 请求，并发送 HTTP 应答
+ 流：HTTP/2 中的双向帧传输流
+ 流错误：发生在单独的 HTTP/2 流中的错误

最后，术语"网关 (gateway)", "中间人 (intermediary)", "代理 (proxy)", "隧道 (tunnel)"均在 [RFC7230] 的第 2.3 节进行了定义。中间人在不同时段可分别担当客户端或者服务器。

术语"请求体 (payload body)"在 [RFC7230] 的 3.3 节中定义。
